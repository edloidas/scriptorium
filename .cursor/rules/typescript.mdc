---
description:
globs: *.ts,*.tsx
alwaysApply: false
---

# TypeScript Coding Standards

## Code Style

```typescript
// Spaces inside `{}` in imports, types, objects, or destructuring
import { Data } from './components/Button';
type IdBad = { id: string };
const bar = { foo: 1; };
function getIdBad({ id }: IdBad): string {
  const { foo } = bar;
  return id;
}

// Prefer single quotes over double quotes
import { atom } from 'nanostores';
const $note = atom(`Time: ${Date.now()}`);

// Check for both null and undefined with `!= null`
if (response != null) {
  // safe to use response
}

// No nested ternaries - use if/else or object lookup
const statusMap = { loading: isLoading, error: isError };

// Leverage modern TypeScript syntax
const len = items?.length ?? 0;
settings.debug ||= false;
cache?.clear();
const size = 1_000;

// Prefer `const` over `let` if variable won't change
const max = 100;

// Prefer destructing assignment
const [body, headers = {}] = request;
const { signal } = new AbortController();

// Prefer single-line guard clauses (early return)
if (element == null) return;
if (!isSupported) return false;

// Insert exactly one blank line between logically distinct operations
const result = doSomething();

updateAnotherThing();

// End every source file with a single trailing newline
```

## Naming Standards

```typescript
// Standalone booleans use `is`/`has`/`can`/`should`/`will` prefixes
const isEnabled = true;
const hasFocus = false;
const canEdit = permissions.includes('edit');
const shouldUpdate = version < latest;
const willUnmount = false;

// React props: drop prefixes for boolean props
interface ButtonProps {
  disabled?: boolean; // Not 'isDisabled'
  loading?: boolean; // Not 'isLoading'
  active?: boolean; // Not 'isActive'
  onClick?: () => void; // Event handlers use 'on' prefix
  onChange?: (value: string) => void;
}

// Internal handlers use 'handle' prefix
const handleClick = () => {
  onClick?.();
};

// Arrays use plural forms
const users: User[] = [];
const selectedIds: string[] = [];

// Functions use verb prefixes
function getUserById(id: string) {} // get/fetch/load/parse
function setUserName(name: string) {} // set/update/save/calc/compute
function isValidEmail(email: string) {} // is/has for boolean returns

// Add comma after the last element in multi-line function arguments, arrays, objects
function add(
  firstNumericValue: number,
  secondNumericValue: number,
): number {
  // ...
}

// Name constants using UPPERCASE and underscore
const TIMEOUT_MS = 30_000;
const MAX_RETRIES = 3;
```

## Type Definitions

```typescript
// Prefer types for object shapes
type User = {
  id: string;
  name: string;
}

// Use type aliases for unions/primitives
type UserStatus = 'active' | 'inactive' | 'pending';
type UserId = string;

// Use T[] syntax for arrays
type Users = User[];
const items: string[] = [];

// Use unknown and type guards instead of any
const data: unknown = fetchData();
if (isUser(data)) {
  // TypeScript knows data is User here
}

// Prefer defining type separately instead of setting shape in generics
type Identifiable = { id: string; }
function getById<T extends Identifiable>(items: T[], id: string): T {
  return items.find(item => item.id === id);
}

// Use `satisfies` for precise literal types without widening
const options = {
  retry: 3,
  timeout: 5000,
} satisfies RequestOptions;

// Prefer `undefined` over `null` for unset values
const [activeId, setActiveId] = useState<string | undefined>(undefined);

// Exception: refs use `null` (React convention)
const ref = useRef<HTMLDivElement | null>(null);
```

## Function Signatures

```typescript
// Explicit return types for public functions
export function calculateTotal(items: OrderItem[]): number {
  return items.reduce((sum, item) => sum + item.price, 0);
}

// Prefer arrow functions without explicit return type in handlers
export function add2(values: number[]): number[] {
  return values.map(v => v + 2);
}

// Prefer arrow functions with return type in one-line helpers
const isEven = (value: number): boolean => value % 2 === 0;

// Use generic constraints
function updateEntity<T extends { id: string }>(entity: T, updates: Partial<T>): T {
  return { ...entity, ...updates };
}
```

## Import/Export Standards

```typescript
// Named exports preferred
export { UserService, ProductService };

// Group imports by source
import React, { useState, useEffect } from 'react';
import { Router } from 'express';

import { UserService } from '../services/UserService';
import { validateEmail } from '../utils/validation';

import type { User, CreateUserInput } from '../types';

// Prefer importing local files with alias `@/` instead of long relative paths
import { MyComponent } from '@/components/MyComponent';

// Import with relative paths only from the same directory
import { MyComponent } from './MyComponent';
```
